#!/bin/bash

# Load environment variables from Cazar Main.env
# This script properly handles multiline certificates

cd /Users/dannydemichele/Cazar

# Export variables from .env file
export ADP_CLIENT_ID="b2756f2e-79af-403c-9758-2bccecdcbd42"
export ADP_CLIENT_SECRET="9ebde91d-f4ea-4f7e-8d00-7cfdcd6ece66"
export DATABASE_URL="postgresql://cazar_admin:7m0bT1rRf0TCnGYeaDOCujeLmcXGsJke@dpg-d25rt60gjchc73acglmg-a.oregon-postgres.render.com/cazar_ops_hub"

# Export certificate (properly escaped)
export ADP_CERTIFICATE="-----BEGIN CERTIFICATE-----
MIIFTDCCBDSgAwIBAgIQaxQZgOM6tRNeqlAMKfgidzANBgkqhkiG9w0BAQsFADCB
yDELMAkGA1UEBhMCVVMxKDAmBgNVBAoTH0F1dG9tYXRpYyBEYXRhIFByb2Nlc3Np
bmcsIEluYy4xFzAVBgNVBAsTDldlYiBUaWVyIEdyb3VwMTUwMwYDVQQLEywoQykg
MjAxNiBBRFAsIEluYy4gLSBGb3IgYXV0aG9yaXplZCB1c2Ugb25seTE/MD0GA1UE
AxM2QXV0b21hdGljIERhdGEgUHJvY2Vzc2luZyBBcHBsaWNhdGlvbiBTZXJ2aWNl
cyBDQSAtIEczMB4XDTI1MTAxNDE5NDI1NFoXDTI3MTAxNDE5NDI1NFowgZExCzAJ
BgNVBAYTAlVTMQswCQYDVQQIEwJOWTERMA8GA1UEBxMITmV3IFlvcmsxHDAaBgNV
BAoTE0NhemFyIExvZ2lzdGljcyBMTEMxDTALBgNVBAsTBE9wcHMxIDAeBgkqhkiG
9w0BCQEMEXJ1ZHlAY2F6YXJueWMuY29tMRMwEQYDVQQDEwpDYXphciBNYWluMIIB
IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqP+REzal6YvaeMPE0iDiJ5/E
JWLlJy9WvahMzfrE5H8EibyrnyC4zjFPvGo4Z7TWLTwE2CALnk8hl6YmyvptFdqT
NGM+8scnWTMfLxysUeQJpYAMd9kk4x1D1VMElYFXBWD2ilKE4Z1HEr9cP3i6Nzzp
NGJx5iK+mYqWElMBgvDeV/rfLPrhk2VzclI1iW0uJ2f5jRV8O13+rvJYnAk8svim
OKPFgXD5VjpXPOPuPsfPSRXpJI5yh4vll2UKgiujfr7YWWDR7yNEg+zTuKbWXHR2
LPVExhmVBi3p/dGv0pvzaksec19Ng4ZI7ZYbIv717Fm6h1ymhnbScuibWDGl0QID
AQABo4IBZTCCAWEwHwYDVR0jBBgwFoAUrl6sNeCNEBlLSSQiw8kEWFsntsIwCQYD
VR0TBAIwADBZBgNVHR8EUjBQME6gTKBKhkhodHRwOi8vY3JsV1MuYWRwLmNvbS9B
dXRvbWF0aWNEYXRhUHJvY2Vzc2luZ0FwcGxpY2F0aW9uU2VydmljZXNDQS1HMy5j
cmwwgYcGCCsGAQUFBwEBBHsweTBUBggrBgEFBQcwAoZIaHR0cDovL2NydFdTLmFk
cC5jb20vQXV0b21hdGljRGF0YVByb2Nlc3NpbmdBcHBsaWNhdGlvblNlcnZpY2Vz
Q0EtRzMuY3J0MCEGCCsGAQUFBzABhhVodHRwOi8vb2NzcFdTLmFkcC5jb20wDgYD
VR0PAQH/BAQDAgWgMB8GA1UdJQQYMBYGCisGAQQBgjcUAgIGCCsGAQUFBwMCMB0G
A1UdDgQWBBTJd8qCaPRwUajifY+CGDePlzTB/zANBgkqhkiG9w0BAQsFAAOCAQEA
FaK+YYwLXysXQVExIpx7vK5FEFibinxbcbdFMxx5N42jgCkUY6h81JrsTfx0/T1s
JCl3htq9IEVfQW51CYZjO0D313cjsmxlwTVImePxPjQvPGosu9T/k4+DruU+iVjn
WJU27n+gE129MxVQsahI3kZOA8qRY3pBey/VlnREEkzrGBLwUw7Mb/vllR92I9/6
hEoud66XI0jo8SG5wEyb8NyQwXXjUQFM+7P3i1Ttb00kW6DtgA2JBjrFdB8ekhwp
iNTXoXWvjeZ3C//ygjTlGDPPlRT4Tkkuh80b7OSK1imq8nSUt7F1XnGbD5nynGQq
CxujtAzopxM6amFuH7dxeA==
-----END CERTIFICATE-----"

# Export private key (properly escaped)
export ADP_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCo/5ETNqXpi9p4
w8TSIOInn8QlYuUnL1a9qEzN+sTkfwSJvKufILjOMU+8ajhntNYtPATYIAueTyGX
pibK+m0V2pM0Yz7yxydZMx8vHKxR5AmlgAx32STjHUPVUwSVgVcFYPaKUoThnUcS
v1w/eLo3POk0YnHmIr6ZipYSUwGC8N5X+t8s+uGTZXNyUjWJbS4nZ/mNFXw7Xf6u
8licCTyy+KY4o8WBcPlWOlc84+4+x89JFekkjnKHi+WXZQqCK6N+vthZYNHvI0SD
7NO4ptZcdHYs9UTGGZUGLen90a/Sm/NqSx5zX02Dhkjtlhsi/vXsWbqHXKaGdtJy
6JtYMaXRAgMBAAECggEACsLDLRMEu3tBPQFSLgMUA2vj5HGIn9ce0dK+mTsHgHkq
A880qlw+CDsRlbC5yLi2DolM0aowszLcs7hLrg8GFScmymYrYvAVbFOZ/7j2q/w2
NQiTQqpb8+4wHIw9tXtX3CrRZ/tbJLaMCQCQUiZQzSWev8wo7nt14Xb2mVIZvYmY
FV2M59/uVXzGLPBu38qJ0LdGJoqvxmtZgrOYyRYzDMPat5MgE3Q4whV0uvq3mZoQ
1nv2NlNengFWkLs8WwbC2CrRKJBPNAWXYxQ4md3EJL6ZB5YQwbg3F1JoE0zrHWg+
Z3MJW9aFByNf7rewG5/Ymvi+aDGdaa/lAg6HjUcJpQKBgQDtp8TbIPdAokNEMZfS
qjKoIvc0JouWHFD4TJRXUPH1AiPnouRKBp+tUPjo7MH1lZiZf/owpmOqsVsCzlgO
T1fq3hPYalNFUcfBJJlPwuGYEhwqLzkLQdadNQ7h1dTaFrHzB87Xrf2Y+dzt/zT4
IwWO/1BwqrDgQtEYolsMVX7IowKBgQC2CxaHPdZ29IA/9O1wK6Qvzz9VdDqelaBi
VwLvxH9BIPqQ2vTv0aqS+t/2WnkMVWe+rYO41+G4WrPjNeReRqKHbpGFVvIUiexT
6QMrvPDcOhqYimXEHLXCaYmRGaIEJ09rVLd84vVQUXF2xuU6G8RiZb7KU2/c4fbo
AwIkN7o6+wKBgQDXEThIxbB7wVv2XpryfiuRlPL5MtinY8CyszqbOhl8jA9KFFNb
2lquUdSvlXKBeHu8jeAwHqObWRzvkSSG7q61UXvMIYxx8uw+kYxcbhQRtnHeixWo
ZlB9vAJXxVb2dgtbz/kTndUdlyCkEIwy8h6Zpdt52j5u9IidLnAO3V/62QKBgQC0
cBMZY+qyp7CDNEMwvqEUHmkZS4Za79Y0AyjO/UZhCM4zTEQhfQGEhBP/fDelSPX2
4sfALIL4Fzdci2tbIsowUSD+OGrkfrz3gut4q+NVdmYsMmmiVA64r6ECaJTVZx1q
NmNU7yTWQpOjdot46FLkcRMGOmOTXYo899ZkjbQShwKBgHlxuy4tZhe2w8tnYFkE
vZngueDAYyzERJfnGHISIUrYHRKX8QigSRk5jUFGRjDZKwsjRWIjuEL/vP/Oodm5
9N0gFc3rUHqOknLbnlPF0t+6/4KJJ2EYnWK4nDU3gxVTy+JTVsKkkK3KPgC1sAw6
T6FuipGtUF7l0kvqYcieTIjE
-----END PRIVATE KEY-----"

# Run the ADP loader script with arguments
node scripts/load_adp_reports.mjs "$@"

